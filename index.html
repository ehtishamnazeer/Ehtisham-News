<script>
    async function superFetch() {
        const uid = document.getElementById('uidInput').value.trim();
        const region = document.getElementById('region').value;
        const btn = document.getElementById('mainBtn');
        const resBox = document.getElementById('resultBox');

        if(!uid) return alert("UID to dalo!");

        btn.innerText = "OB51 SCANNING...";
        btn.disabled = true;

        // OB51 Updated Endpoints
        const apiPool = [
            `https://free-ff-api-src-5plp.onrender.com/api/v1/account?region=${region}&uid=${uid}`,
            `https://ff-api-v2.vercel.app/api/info?uid=${uid}&region=${region}`, // New V2 Endpoint
            `https://ashqking.com/api/ff_info?uid=${uid}&region=${region.toLowerCase()}`
        ];

        const proxy = "https://api.allorigins.win/get?url=";
        let found = false;

        for (let apiUrl of apiPool) {
            try {
                const response = await fetch(proxy + encodeURIComponent(apiUrl));
                const wrapper = await response.json();
                const data = JSON.parse(wrapper.contents);

                if (data && (data.basicInfo || data.nickname)) {
                    document.getElementById('resName').innerText = data.basicInfo?.nickname || data.nickname;
                    document.getElementById('resLevel').innerText = data.basicInfo?.level || data.level;
                    resBox.classList.remove('hidden');
                    found = true;
                    break; 
                }
            } catch (e) {
                console.log("Switching to next OB51 API...");
            }
        }

        if(!found) {
            alert("OB51 Security Alert: Public APIs are currently updating. Please try again after some time or check another UID.");
        }

        btn.innerText = "RUN BYPASS SCAN";
        btn.disabled = false;
    }
</script>

