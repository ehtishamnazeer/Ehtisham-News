<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ehtisham News | Gaming Portal</title>

<meta name="theme-color" content="#c9a23f">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --gold: #c9a23f;
  --dark: #121212;
  --glass: rgba(255, 255, 255, 0.9);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: #f0f2f5;
  color: #1a1a1a;
  overflow-x: hidden;
}

/* --- PREMIUM INTRO SPLASH --- */
#splash {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, #1e1e1e, #000);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  transition: opacity 0.8s ease, visibility 0.8s;
}

#splash.fade-out { opacity: 0; visibility: hidden; }

#splash h1 {
  font-size: 3rem;
  color: #fff;
  margin: 0;
  letter-spacing: -1px;
  animation: logoIn 1.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

#splash h1 span { color: var(--gold); }

#splash p {
  color: #888;
  margin-top: 10px;
  letter-spacing: 2px;
  text-transform: uppercase;
  font-size: 0.8rem;
  opacity: 0;
  animation: fadeIn 1s 0.8s forwards;
}

@keyframes logoIn {
  from { opacity: 0; transform: scale(0.8) translateY(20px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

/* --- HEADER --- */
header {
  background: #fff;
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 15px rgba(0,0,0,0.05);
  position: sticky;
  top: 0;
  z-index: 900;
}

header h2 { margin: 0; font-size: 1.5rem; }
header h2 span { color: var(--gold); }
header p { margin: 5px 0 0; font-size: 0.75rem; color: #777; font-weight: 600; }

/* --- CONTAINERS & ANIMATIONS --- */
.container { 
  padding: 20px; 
  max-width: 600px; 
  margin: 0 auto;
  animation: pageIn 0.5s ease-out;
}

@keyframes pageIn {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeIn { to { opacity: 1; } }

/* --- GLASS CARDS --- */
.card {
  background: var(--glass);
  backdrop-filter: blur(10px);
  border-radius: 24px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.04);
  border: 1px solid rgba(255,255,255,0.2);
  transition: transform 0.2s;
}

.card:active { transform: scale(0.98); }

.card h3 { margin: 0 0 10px; font-size: 1.25rem; display: flex; align-items: center; gap: 10px; }

/* --- BUTTONS --- */
button {
  background: var(--gold);
  color: #fff;
  border: none;
  padding: 12px 24px;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(201, 162, 63, 0.3);
  transition: 0.3s;
}

button:hover { transform: translateY(-2px); }

/* --- FOOTER --- */
footer {
  padding: 40px 20px;
  text-align: center;
  background: #fff;
  border-top-left-radius: 30px;
  border-top-right-radius: 30px;
}

footer a {
  display: inline-block;
  margin: 5px 10px;
  font-weight: 600;
  color: #555;
  font-size: 0.9rem;
}

/* --- INSTALL TOAST --- */
.installBox {
  position: fixed;
  bottom: 30px; left: 20px; right: 20px;
  background: #000;
  color: #fff;
  padding: 15px 25px;
  border-radius: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 9999;
  box-shadow: 0 10px 40px rgba(0,0,0,0.3);
  animation: slideUp 0.5s ease-out;
}

@keyframes slideUp { from { transform: translateY(100px); } to { transform: translateY(0); } }

#home, #newsList, #newsView { display: none; }
</style>
</head>

<body>

<div id="splash">
  <h1>Ehtisham <span>News</span></h1>
  <p>Gaming ‚Ä¢ Esports ‚Ä¢ Community</p>
</div>

<header>
  <h2 onclick="goHome()">Ehtisham <span>News</span></h2>
  <p>GAMING ‚Ä¢ ESPORTS ‚Ä¢ COMMUNITY</p>
</header>

<div class="container" id="home">
  <div class="card" onclick="openCategory('gaming')">
    <h3>üî• Gaming</h3>
    <p>Read the latest updates in the world of gaming.</p>
    <button>Explore</button>
  </div>
  <div class="card" onclick="openCategory('esports')">
    <h3>üèÜ Esports</h3>
    <p>Tournament results and pro-player news.</p>
    <button>Explore</button>
  </div>
  <div class="card" onclick="openCategory('community')">
    <h3>üë• Community</h3>
    <p>Stay connected with your fellow gamers.</p>
    <button>Explore</button>
  </div>
</div>

<div class="container" id="newsList">
  <h3 id="catTitle" style="color:var(--gold)"></h3>
  <div id="newsItems"></div>
  <button onclick="goHome()" style="margin-top:20px; background:#444;">‚¨Ö Back</button>
</div>

<div class="container" id="newsView">
  <h2 id="viewTitle"></h2>
  <p id="viewContent" style="line-height:1.8; color:#444; font-size: 1.05rem;"></p>
  <hr style="border:0; border-top:1px solid #ddd; margin: 30px 0;">
  <h4>Recommended News</h4>
  <div id="otherNews"></div>
  <button onclick="goBack()" style="background:#444;">‚¨Ö Back to List</button>
</div>

<footer>
  <a href="https://whatsapp.com">WhatsApp</a> |
  <a href="https://facebook.com">Facebook</a> |
  <a href="https://instagram.com">Instagram</a>
  <p style="font-size: 0.7rem; color:#aaa; margin-top:20px;">&copy; 2024 Ehtisham News. All Rights Reserved.</p>
</footer>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// Firebase Config
firebase.initializeApp({
  apiKey:"AIzaSyC9Cfh60ZyeZTbhK45a_sKWBFCy8DrqDao",
  authDomain:"ehtisham-news.firebaseapp.com",
  projectId:"ehtisham-news"
});
const db = firebase.firestore();

// Pages
const home = document.getElementById("home");
const newsList = document.getElementById("newsList");
const newsView = document.getElementById("newsView");

// --- SPLASH LOGIC ---
window.onload = () => {
  setTimeout(() => {
    document.getElementById('splash').classList.add('fade-out');
    home.style.display = "block";
  }, 2500);
};

// --- DATA LOGIC ---
function openCategory(cat) {
  home.style.display = "none";
  newsView.style.display = "none";
  newsList.style.display = "block";
  document.getElementById("catTitle").innerText = cat.toUpperCase();
  const box = document.getElementById("newsItems");
  box.innerHTML = "<p>Scanning database...</p>";

  db.collection("news")
    .where("category","==",cat)
    .orderBy("date","desc")
    .get()
    .then(snap => {
      if(snap.empty){ box.innerHTML = "No data found."; return; }
      let html = "";
      snap.forEach(d => {
        let n = d.data();
        html += `<div class="card" onclick="openNews('${d.id}','${cat}')">
          <h4 style="margin:0">${n.title}</h4>
          <p style="font-size:0.85rem; color:#666">${n.content.substring(0,80)}...</p>
        </div>`;
      });
      box.innerHTML = html;
    });
}

function openNews(id, cat) {
  newsList.style.display = "none";
  newsView.style.display = "block";
  window.scrollTo(0,0);

  db.collection("news").doc(id).get().then(d => {
    let n = d.data();
    document.getElementById("viewTitle").innerText = n.title;
    document.getElementById("viewContent").innerText = n.content;
  });

  db.collection("news").where("category","==",cat).limit(3).get().then(s => {
    let h = "";
    s.forEach(d => { if(d.id !== id) h += `<div class="card" onclick="openNews('${d.id}','${cat}')"><h5>${d.data().title}</h5></div>`; });
    document.getElementById("otherNews").innerHTML = h;
  });
}

function goHome() { 
  newsList.style.display = "none"; 
  newsView.style.display = "none"; 
  home.style.display = "block"; 
}
function goBack() { 
  newsView.style.display = "none"; 
  newsList.style.display = "block"; 
}

// --- PWA & NOTIFICATIONS ---
if ("Notification" in window) {
  if (Notification.permission !== "granted") {
    setTimeout(() => { Notification.requestPermission(); }, 5000);
  }
  
  db.collection("notifications").orderBy("time","desc").limit(1)
    .onSnapshot(s => {
      s.docChanges().forEach(change => {
        if (change.type === "added") {
          let n = change.doc.data();
          new Notification(n.title, { body: n.body, icon: 'https://cdn-icons-png.flaticon.com/512/1042/1042680.png' });
        }
      });
    });
}

// --- SMART INSTALL TOAST ---
let deferredPrompt;
window.addEventListener("beforeinstallprompt", e => {
  e.preventDefault();
  deferredPrompt = e;
  const box = document.createElement("div");
  box.className = "installBox";
  box.innerHTML = `<span>Add to Home Screen?</span><button id="installBtn">Install</button>`;
  document.body.appendChild(box);
  
  document.getElementById("installBtn").onclick = () => {
    box.remove();
    deferredPrompt.prompt();
  };
});
</script>

</body>
</html>
